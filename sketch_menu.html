<html>
  <head>
  <meta charset="UTF-8">
  <script src="https://github.com/processing/p5.js/releases/download/0.5.16/p5.js"></script> 
  <script>
var opcao = 1 
var telaAtiva = 1;
var flip_img;
var r_1 = '#14283b'; var r_2 = '#14283b'; var r_3 = '#14283b'; var r_4 = '#14283b';
var astro = {
	x:50,
	y:300,
	width:33,
	height:50
};
var astro_invertido = {
	x:50,
	y:300,
	width:33,
	height:50
};
var nave = {
	x:30,
	y:-300,
	width:290,
	height:280
}

var fase = 1; //define a tela do jogo
var i = 0; //indice do vetor texto
var texto1 = ['Preparado para uma'+'\n'+'aventura sem igual no'+'\n'+'nosso sistema solar?', 
							'Mas antes, vamos'+'\n'+'conhecer a sua nave'];


function preload() { 
	space_dn = loadImage('space_dn.png'); //space background
	astro_0 = loadImage('astro_0.png'); //astro
	ceu = loadImage('country-platform-back.png'); //plano de fundo da tela de jogo
	piso = loadImage('country-platform-tiles-example.png'); //chao da tela de jogo
	capitao = loadImage('mestre.png'); //o capitao
	dialogo = loadImage('Dialog_Box.png'); //caixa de dialogo
	nave_0 = loadImage('ship_2_edit.png'); //nave pousada
	nave_1 = loadImage('ship_2_fire.png'); //nave com fogo
	spacebar = loadImage('spacebar.png'); //imagem barra de espaÃ§o
	console1 = loadImage('console_w.png');
	console2 = loadImage('console_s.png');
	astro_invertido = loadImage('fliped.png');//astro invertido horizontalmente
	flip_img = astro_0;
}

	function show() { //funcao para carregar as imagens
		image(ceu, 0, 0, width, height);
		image(piso, 0, 0, width, height);
		image(flip_img, astro.x, astro.y, 33, 50);
		image(capitao, 500, 280);
	}

function setup() {
  createCanvas(600, 400);
}

function draw() {
  //imageMode(CENTER); (usar para centralizar a imagem)
		switch(telaAtiva) { //menu
    case 1:
      menu();
      break;
    case 2:
      jogar();
			break
    case 3:
      regras();
      break;   
    case 4:
      recordes();
      break; 
    case 5:
      sair();  
  }
}

function jogar(){ //codigo do jogo
	background(0);
	if(fase === 1){ //tela de inicio
		show(); //carregar as imagens
		if(keyIsDown(RIGHT_ARROW)) { //anda para direita
			astro.x = astro.x + 5;
			flip_img = astro_0;
		}
		if(keyIsDown(LEFT_ARROW)) { //anda para esquerda
			astro.x = astro.x - 5;
			flip_img = astro_invertido;
		}
		if(astro.x >= 480){ //esbarra com o capitao
			astro.x = 480;
			image(dialogo, 400, 190, 200, 90);
			image(spacebar, 560, 280, 35, 15);
			textSize(18);
			text(texto1[i], 415, 215); //texto do capitao
		}
		if(astro.x < 0){
			astro.x = 0;
		}
	
		if(i === (texto1.length - 1)){
			
			if(nave.y<100){
			image(nave_1, nave.x, nave.y, nave.width, nave.height);
			nave.y++;
			}
			
			if(nave.y === 100){
				 image(nave_0, nave.x, nave.y, nave.width, nave.height);
			}
		
			if(astro.x <= 250){
				astro.x = 250;
				image(spacebar, 253, 280, 35, 15);
				if(keyCode === 32){
					fase = 2;
					keyCode = 0;
				}
			}
		}
	}
	
	if(fase === 2){ //tela dentro da nave
		
		image(console1, 400, 200);
		image(console2, 300, 190);
		if(keyCode === CONTROL){
			fase = 1;
			keyCode = 0;
		}
	}
	
	keyCode=0; //faz parar de andar
		
}

function sair() {
   
  background('#7FDBFF');
   
  fill('white');
  stroke('black');
  strokeWeight(1);
  
  textSize(28);
  fill('black');
  
  text('saindo', 40, 55);
  window.close();
}



function regras() {
   
  background(0);
  image(space_dn,0 ,0); //chamando o space background

  
  textSize(28);
  fill('yellow');
  
  text('Aqui vao as regras', 40, 55);
}

function menu() { //funcao menu
  //codigo de selecao (verde)
  background('#000000');
	if(opcao == 1){
		r_1 = 'green';
	}else{
		r_1 = '#14283b';
	}
	
	if(opcao == 2){
		r_2 = 'green';
	}else{
		r_2 = '#14283b';
	}
	
	if(opcao == 3){
		r_3 = 'green';
	}else{
		r_3 = '#14283b';
	}
	
	if(opcao == 4){
		r_4 = 'green';
	}else{
		r_4 = '#14283b';
	}
	image(space_dn,0 ,0); //chamando o space background
	
	//retangulos dos textos do menu
  stroke('black');
  strokeWeight(1);
	fill(r_1);
  rect(235, 65, 120, 55, 10);
	fill(r_2);
  rect(235, 125, 130, 55, 10);
	fill(r_3);
  rect(235, 185, 160, 55, 10);
	fill(r_4);
  rect(235, 245, 100, 55, 10);
  
	//textos dos retangulos do menu
  textSize(32);
  fill('yellow');
  text('Jogar', 250, 100);
  text('Regras', 250, 160);
  text('Recordes', 250, 220);
  text('Sair', 250, 280);
  stroke('white');
  fill('white');
	
	//desenho do astronauta da tela do menu
  ellipse(200, 200,60);// cabeca
  rect(170,230,60,50); // corpo
  rect(160,230,10,25); // braco e
  rect(230,230,10,25); // braco d
  rect(178,280,20,25); // perna e
  rect(202,280,20,25); // perna d
  stroke('orange')
  fill('orange')
  rect(160,255,10,7); // mao e
  rect(230,255,10,7); // mao d
  stroke('black');
  fill('black');
  ellipse(200, 202, 60, 40);
  

}

function keyPressed() { //selecao pelas teclas
  console.log(keyCode);
  
  if(keyCode === BACKSPACE) //para voltar a tela inicial
      telaAtiva=1;
	
	if(keyCode === 32 && i<(texto1.length - 1)){ //passa as frases do vetor texto
		i++;
	}
	
  if(telaAtiva===1){
  	if (keyCode === ENTER) //seleciona
 	     telaAtiva=opcao+1;
     
 	 if (keyCode === DOWN_ARROW) { //para baixo
 	      if(opcao==1){
 	          opcao=2;
				 }
  	     else if(opcao==2){
    	         opcao=3; 
				 }
				 else if(opcao==3){
					 		opcao=4;
				 }
    
  	} else if (keyCode === UP_ARROW) { //para cima
  	     if(opcao==2) {
  	       opcao=1;
  	     } 
				else if(opcao==3){
					opcao=2;
				}
				else if(opcao==4){
					opcao=3;
				}
   
  	}
	}
	
  console.log("opcao: "+opcao);
  console.log("telaAtiva: "+telaAtiva);
}
    </script>
    <style> body {padding: 0; margin: 0;} </style>
  </head>
</html>
